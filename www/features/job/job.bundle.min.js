angular.module("starter").controller("JobListController",function(Location,SocialSharing,Modal,$rootScope,$scope,$state,$stateParams,$timeout,$translate,$window,Application,Dialog,Job){angular.extend($scope,{isLoading:!0,value_id:$stateParams.value_id,offset:null,modal:null,load_more:!1,card_design:!1,admin_modal:null,can_load_older_places:!1,social_sharing_active:!1,collection:[],categories:[],distance_range:[1,5,10,20,50,75,100,150,200,500,1000],distance_unit:"km",filters:{fulltext:"",locality:null,longitude:0,latitude:0,keywords:null,radius:4,distance:0,categories:null,more_search:!1}});$scope.Math=window.Math;Job.setValueId($stateParams.value_id);$scope.validateFilters=function(){$scope.closeFilterModal();Job.collection=[];$scope.collection=[];$scope.loadContent(!0)};$scope.clearFilters=function(){if($scope.categories){$scope.categories.forEach(function(category){category.isSelected=!1})}
$scope.filters.fulltext="";$scope.filters.locality=null;$scope.filters.more_search=!1;$scope.filters.position=!1;$scope.filters.keywords=null;$scope.filters.radius=Job.settings.default_radius||4;$scope.filters.distance=0;$scope.closeFilterModal();Job.collection=[];$scope.collection=[];$scope.loadContent()};$scope.refresh=function(){Job.collection=[];$scope.collection=[];$scope.loadContent(!0)};$scope.filterModal=function(){Modal.fromTemplateUrl("features/job/assets/templates/l1/more.html",{scope:$scope}).then(function(modal){$scope.modal=modal;$scope.modal.show()})};$scope.closeFilterModal=function(){$scope.modal.hide()};$scope.adminModal=function(){if($rootScope.isNotAvailableOffline()){return}
Modal.fromTemplateUrl('features/job/assets/templates/l1/admin-modal.html',{scope:$scope}).then(function(modal){$scope.admin_modal=modal;$scope.admin_modal.show()})};$scope.closeAdminModal=function(){$scope.admin_modal.hide()};$scope.loadMore=function(){$scope.loadContent(!1,!0)};$scope.loadContent=function(refresh,loadMore){$scope.isLoading=!0;$scope.filters.offset=$scope.collection.length;if($scope.collection.length<=0){$scope.collection=[]}
if($scope.categories){$scope.filters.categories=$scope.categories.filter(function(category){return category.isSelected}).map(function(category){return category.id}).join(",")}else{$scope.filters.categories=""}
if(Location.isEnabled){Location.getLocation({timeout:10000},!0).then(function(position){$scope.filters.latitude=position.coords.latitude;$scope.filters.longitude=position.coords.longitude},function(error){$scope.filters.latitude=0;$scope.filters.longitude=0}).then(function(){$scope.findAll(refresh,loadMore)})}else{$scope.filters.latitude=0;$scope.filters.longitude=0;$scope.findAll(refresh,loadMore)}};$scope.findAll=function(refresh,loadMore){Job.findAll($scope.filters,refresh).then(function(data){Job.collection=Job.collection.concat(angular.copy(data.places));$scope.collection=Job.collection;$scope.load_more=(data.total>$scope.collection.length)}).then(function(){if(loadMore){$scope.$broadcast('scroll.infiniteScrollComplete')}
$scope.isLoading=!1})};$scope.imageSrc=function(picture){if(!picture.length){return"./features/job/assets/templates/l1/img/no-category.png"}
return IMAGE_URL+"images/application"+picture};$scope.showCompany=function(company_id){$scope.closeAdminModal();$state.go("company-view",{value_id:$scope.value_id,company_id:company_id})};$scope.showItem=function(item){$state.go("job-view",{value_id:$scope.value_id,place_id:item.id})};$rootScope.$on('location.request.success',function(){$scope.loadContent(!0)});Job.fetchSettings().then(function(payload){Job.settings=$scope.settings=payload.settings;Job.admin_companies=$scope.admin_companies=$scope.settings.admin_companies;Job.categories=$scope.categories=$scope.settings.categories;$scope.cardDesign=$scope.settings.cardDesign;$scope.filters.radius=Job.settings.default_radius||4;$scope.filters.distance_unit=Job.settings.distance_unit||4;Job.collection=[];$scope.collection=[];$scope.loadContent(!0)})});angular.module("starter").controller('JobViewController',function(SocialSharing,Modal,$location,$rootScope,$scope,$state,$stateParams,$timeout,$translate,$window,Application,Customer,Dialog,Job,Loader,Picture){angular.extend($scope,{is_loading:!0,value_id:$stateParams.value_id,is_admin:!1,modal:null,manage_modal:null,social_sharing_active:!1,settings:Job.settings,form:{fullname:"",email:"",phone:"",address:"",message:"",resumes:[]},cardDesign:Job.settings.cardDesign});Job.setValueId($stateParams.value_id);$scope.loadContent=function(){Job.find($stateParams.place_id).then(function(data){$scope.place_edit=$scope.place=data.place;$scope.page_title=data.page_title;$scope.is_admin=data.is_admin;$scope.socialSharing=(data.socialSharing&&IS_NATIVE_APP)}).then(function(){$scope.is_loading=!1})};$scope.contactAction=function(){switch($scope.place.display_contact){case "contactform":case "both":$scope.contactModal();break;case "email":$window.open("mailto:"+$scope.place.email+"?subject="+$translate.instant("New contact for: ","job")+$scope.place.title,"_system");break}};$scope.contactModal=function(){if(Customer.isLoggedIn()){$scope.form.fullname=Customer.customer.firstname+" "+Customer.customer.lastname;$scope.form.email=Customer.customer.email}
Modal.fromTemplateUrl("features/job/assets/templates/l1/contact.html",{scope:$scope}).then(function(modal){$scope.modal=modal;$scope.modal.show()})};$scope.takePicture=function(){Picture.takePicture().then(function(success){$scope.form.resumes.push(success.image)})};$scope.removePicture=function(index){$scope.form.resumes.splice(index,1)};$scope.clearForm=function(){$scope.form.fullname="";$scope.form.email="";$scope.form.phone="";$scope.form.address="";$scope.form.message="";$scope.form.resumes=[]};$scope.closeContactModal=function(){$scope.clearForm();$scope.modal.hide()};$scope.submitContact=function(){if($rootScope.isNotAvailableOffline()){return}
if($scope.form.fullname===""||$scope.form.email===""||$scope.form.message===""){Dialog.alert("Form error","Name, e-mail & message are required !","OK",-1,"job");return}
Loader.show();var options=angular.extend($scope.form,{place_id:$stateParams.place_id,value_id:$scope.value_id});Job.contactForm(options).then(function(data){Dialog.alert("Thank you",data.message,"OK",-1,"job").then(function(){$scope.closeContactModal()})}).then(function(){Loader.hide()})};$scope.submitManage=function(){if($rootScope.isNotAvailableOffline()){return}
if($scope.place_edit.title===""||$scope.place_edit.subtitle===""){Dialog.alert("Form error","All fields are required !","OK",-1,"job");return}
Loader.show();var options=angular.extend($scope.place_edit,{place_id:$stateParams.place_id,value_id:$scope.value_id});Job.editPlace(options).then(function(data){Dialog.alert("Thank you",data.message,"OK",-1,"job").then(function(){$scope.closeManageModal()});$scope.loadContent()},function(data){Dialog.alert("Error",data.message,"OK",-1,"job")}).then(function(){Loader.hide()})};$scope.manageModal=function(){if($rootScope.isNotAvailableOffline()){return}
Modal.fromTemplateUrl("features/job/assets/templates/l1/manage-place.html",{scope:$scope}).then(function(modal){$scope.manage_modal=modal;$scope.manage_modal.show()})};$scope.displayContact=function(place){return(place.display_contact!=="hidden"&&place.email.length>0)};$scope.displayContactForm=function(place){return(place.display_contact==="contactform"||place.display_contact==="both")};$scope.displayEmail=function(place){return(place.display_contact==="email"||place.display_contact==="both")&&place.email.length>0};$scope.closeManageModal=function(){$scope.manage_modal.hide()};$scope.showCompany=function(company_id){$state.go("company-view",{value_id:$scope.value_id,company_id:company_id})};$scope.goHome=function(item){$state.go("job-list",{value_id:$scope.value_id})};$scope.share=function(){SocialSharing.share($translate.instant("job: $1","job").replace("$1",$scope.place.title))};$scope.loadContent()});angular.module("starter").controller('CompanyViewController',function(Modal,$ionicScrollDelegate,$rootScope,$scope,$state,$stateParams,$timeout,$translate,$window,Application,Dialog,Job,Loader){angular.extend($scope,{is_loading:!0,value_id:$stateParams.value_id,is_admin:!1,manage_modal:null,create_modal:null,place_create:{name:null,description:null,location:null,email:null,contract_type:null,income_from:null,income_to:null,category_id:null,keywords:null,is_active:null},social_sharing_active:!1,cardDesign:Job.settings.cardDesign});Job.setValueId($stateParams.value_id);$scope.loadContent=function(){Job.findCompany($stateParams.company_id).then(function(data){$scope.company_edit=$scope.company=data.company;$scope.categories=data.categories;$scope.page_title=data.page_title;$scope.is_admin=data.is_admin;$scope.socialSharing=(data.socialSharing&&IS_NATIVE_APP)}).then(function(){$scope.is_loading=!1;$ionicScrollDelegate.scrollTop()})};$scope.submitManage=function(){if($rootScope.isNotAvailableOffline()){return}
if($scope.company_edit.title===""||$scope.company_edit.location===""||$scope.company_edit.email===""){Dialog.alert("Form error","Required fields are missing!","OK",-1);return}
var options=angular.extend($scope.company_edit,{company_id:$stateParams.company_id,value_id:$scope.value_id});Job.editCompany(options).then(function(data){Dialog.alert("Thank you",data.message,"OK",-1).then(function(){$scope.closeManageModal();$scope.loadContent()})},function(data){Dialog.alert("Form error",data.message,"OK",-1)}).then(function(){})};$scope.manageModal=function(){if($rootScope.isNotAvailableOffline()){return}
Modal.fromTemplateUrl("features/job/assets/templates/l1/manage-company.html",{scope:$scope}).then(function(modal){$scope.manage_modal=modal;$scope.manage_modal.show()})};$scope.closeManageModal=function(){$scope.manage_modal.hide()};$scope.submitCreate=function(){if($rootScope.isNotAvailableOffline()){return}
var options=angular.extend($scope.place_create,{company_id:$stateParams.company_id,value_id:$scope.value_id});Loader.show();Job.createPlace(options).then(function(data){Dialog.alert("Thank you",data.message,"OK",-1).then(function(){$scope.closeCreateModal();$scope.loadContent()})},function(data){Dialog.alert("Form error",data.message,"OK",-1)}).then(function(){Loader.hide()})};$scope.createModal=function(){Modal.fromTemplateUrl("features/job/assets/templates/l1/create-place.html",{scope:$scope}).then(function(modal){$scope.create_modal=modal;$scope.create_modal.show()})};$scope.closeCreateModal=function(){$scope.place_create={name:null,description:null,location:null,email:null,contract_type:null,income_from:null,income_to:null,category_id:null,keywords:null,is_active:null};$scope.create_modal.hide()};$scope.showPlace=function(place_id){$state.go("job-view",{value_id:$scope.value_id,place_id:place_id})};$scope.goHome=function(item){$state.go("job-list",{value_id:$scope.value_id})};$scope.loadContent()});angular.module("starter").factory("Job",function($rootScope,$pwaRequest){var factory={};factory.value_id=null;factory.admin_companies=null;factory.collection=[];factory.settings=null;factory.setValueId=function(value_id){factory.value_id=value_id};factory.findAll=function(filters,refresh){if(!this.value_id){return $pwaRequest.reject("[Factory::Job.findAll] missing value_id.")}
angular.extend(filters,{value_id:this.value_id});return $pwaRequest.post("job/mobile_list/findall",{urlParams:{value_id:this.value_id},refresh:refresh,data:filters})};factory.fetchSettings=function(){if(!this.value_id){return $pwaRequest.reject("[Factory::Job.fetchSettings] missing value_id.")}
return $pwaRequest.get("job/mobile_list/fetch-settings'",{urlParams:{value_id:this.value_id,t:Date.now()},cache:!1})};factory.find=function(place_id){if(!this.value_id||(place_id===undefined)){return $pwaRequest.reject("[Factory::Job.find] missing value_id or place_id.")}
return $pwaRequest.get("job/mobile_list/find",{urlParams:{value_id:this.value_id,place_id:place_id}})};factory.findCompany=function(company_id){if(!this.value_id||(company_id===undefined)){return $pwaRequest.reject("[Factory::Job.findCompany] missing value_id or company_id.")}
return $pwaRequest.get("job/mobile_list/findcompany",{urlParams:{value_id:this.value_id,company_id:company_id}})};factory.contactForm=function(values){if(!this.value_id){return $pwaRequest.reject("[Factory::Job.contactForm] missing value_id.")}
return $pwaRequest.post("job/mobile_list/contactform",{data:values,cache:!1})};factory.editPlace=function(values){if(!this.value_id){return $pwaRequest.reject("[Factory::Job.editPlace] missing value_id.")}
return $pwaRequest.post("job/mobile_list/editplace",{data:values,cache:!1})};factory.createPlace=function(values){if(!this.value_id){return $pwaRequest.reject("[Factory::Job.createPlace] missing value_id.")}
return $pwaRequest.post("job/mobile_list/createplace",{data:values,cache:!1})};factory.editCompany=function(values){if(!this.value_id){return $pwaRequest.reject("[Factory::Job.editCompany] missing value_id.")}
return $pwaRequest.post("job/mobile_list/editcompany",{data:values,cache:!1})};return factory});Features.insertCSS(":root{--safe-area-inset-top:0;--safe-area-inset-right:0;--safe-area-inset-bottom:0;--safe-area-inset-left:0}@supports (padding-top:constant(safe-area-inset-top)){:root{--safe-area-inset-top:constant(safe-area-inset-top);--safe-area-inset-right:constant(safe-area-inset-right);--safe-area-inset-bottom:constant(safe-area-inset-bottom);--safe-area-inset-left:constant(safe-area-inset-left)}}@supports (padding-top:env(safe-area-inset-top)){:root{--safe-area-inset-top:env(safe-area-inset-top);--safe-area-inset-right:env(safe-area-inset-right);--safe-area-inset-bottom:env(safe-area-inset-bottom);--safe-area-inset-left:env(safe-area-inset-left)}}.platform-overview.platform-cordova{--safe-area-inset-top:1.5em;--safe-area-inset-right:0;--safe-area-inset-bottom:.5em;--safe-area-inset-left:0}.module-job .search-action{position:fixed;z-index:100}.module-job .search-button{position:fixed;bottom:0;z-index:100;margin:0!important}.module-job .svg_filter_text{fill:#fff}.module-job .svg_filter_bg{fill:#ffc900}.module-job .places-filters{margin-bottom:0!important}.module-job .places-filters .card{padding:0!important;margin:1vw!important}.module-job .category-item-block{width:calc(100% \/ 3);padding:1vw}.module-job .category-item-block .category-item{border:2px solid transparent!important;background-size:70%;background-repeat:no-repeat;background-position:center 30%;padding:0!important;margin:0!important}.module-job .category-item-block .category-item img{width:100%}.module-job .category-item-block .category-item h4{position:relative;bottom:.5rem;text-align:center;font-size:.6875rem}.module-job .category-item-block .category-item.category-selected{border:2px solid #444!important}.module-job .categories-container{display:flex;flex-direction:row;flex-flow:row wrap;justify-content:flex-start;padding:0!important}.module-job i.clear-text{position:absolute;right:1.5rem;top:calc(50% - .625rem);font-size:1.25rem}@media screen and (orientation:portrait){.module-job .search-action{width:9vh;height:9vh;bottom:2vh;right:2vh}}@media screen and (orientation:landscape){.module-job .search-action{width:9vw;height:9vw;bottom:2vw;right:2vw}}.module-job .job-search{padding:0;border:0}.module-job .job-search i.icon{font-size:24px;margin-left:4px}.module-job .job-search .textual{width:100%}.module-job .job-search .place{float:right;max-width:200px;font-size:14px;overflow:hidden}.module-job .job-search .place i.icon{font-size:22px;margin-right:6px}.module-job .job-search .more{float:right;max-width:30px}.module-job .job-search .textual,.module-job .job-search .place,.module-job .job-search .more{padding:0;border-radius:0;border:0;background-color:transparent}.module-job .item.item-custom .row{padding:0!important}.module-job .item.item-custom .row .col{padding:0!important}.module-job .item-place{padding:6px 12px}.module-job .item-place .row{padding:0!important}.module-job .item-place .row .col{padding:0!important}.module-job .item-place p.subtitle{font-size:13px;opacity:.7}.module-job .item-place p.subtitle-company{font-size:13px;opacity:.5}.module-job .job-company-logo{position:absolute;width:25%;left:26px;bottom:34px;z-index:1000;border:4px solid rgba(255,255,255,.85);border-radius:2px;background:#fff}.module-job .job-company-header{text-align:left}.module-job .job-company-header p{font-weight:400}.module-job .job-company-header p.employee{margin-left:25vw;padding-left:26px}.module-job .job-company-header p.location{margin-left:12px}.module-job .job-company-header p i{margin-right:6px}.module-job .job-company-header h2{margin-left:25vw!important;padding-left:26px!important}.module-job .item-thumbnail-custom{padding-left:76px}.module-job .item-thumbnail-custom img{position:absolute;top:7px;left:7px;height:60px;border:3px solid rgba(0,0,0,.25);border-radius:3px}.module-job .job-distance{float:right}.module-job .job-more label.item.item-checkbox.ng-valid{border:0;width:50%;float:left;padding:4px 4px 4px 26px;font-size:14px}.module-job .job-more .checkbox input,.module-job .job-more .checkbox-icon{width:20px;height:20px}.module-job .job-more .checkbox.checkbox-input-hidden.disable-pointer-events.checkbox-circle{padding:0}.module-job .job-more i.checkbox-icon ::before{margin-left:-6px;margin-top:10px;border-radius:0}.module-job .job-more i.checkbox-icon ::after{margin-left:-8px;margin-top:0}.module-job .job-more input.ng-valid.ng-touched.ng-dirty.ng-valid-parse{width:100%;margin-top:16px}.module-job .job-padding{padding:0 20%}.module-job .platform-android .job-more i.checkbox-icon::before{margin-top:5px}.module-job .platform-android .job-more i.checkbox-icon::after{margin-left:-10px;margin-top:-1px}.module-job .platform-android .job-more label.item.item-checkbox.ng-valid{margin-bottom:12px}.module-job .job-contact .icon-form{margin-right:10px}.module-job .job-contact textarea{min-height:120px}.module-job .ta-root button{width:10.6%;background:none}.module-job .ta-root .btn-group:first-of-type{margin-bottom:4px}.module-job .ta-root .btn-group button{border:1px solid grey;border-width:1px 0 1px 1px}.module-job .ta-root .btn-group button:first-of-type{border-width:1px 0 1px 1px;border-radius:2px 0 0 2px}.module-job .ta-root .btn-group button:last-of-type{border-width:1px 1px 1px 1px;border-radius:0 2px 2px 0}.module-job .ta-root .ta-editor *{overflow:auto;text-overflow:clip;white-space:normal}.module-job .ta-text.ta-editor{margin-right:4.6%;padding:0}.module-job .ta-editor.ta-html,.module-job .ta-scroll-window.form-control{min-height:200px;height:200px}.module-job .job-line-return{text-overflow:clip;white-space:initial}.module-job .job-small-text{font-size:12px}.module-job .job-inactive{background-color:#ac2925;color:#fff;text-transform:uppercase;padding:0 30px 30px 30px;font-size:11px;font-weight:700;-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-ms-transform:rotate(-45deg);-o-transform:rotate(-45deg);transform:rotate(-45deg);text-align:center;position:absolute;bottom:-10px;right:-42px;z-index:100}.module-job button.create-job{margin-top:-7px;background:transparent;border:none;color:inherit}.module-job .job-admin span{font-size:13px}.module-job .job-card-margin{margin-top:6px;margin-bottom:0}.module-job .job-card-margin:first-of-type{margin-top:12px}.module-job .job-card-margin:last-of-type{margin-bottom:12px}.module-job .add-image-icon{font-size:18px}.module-job .remove-image-list,.module-job .remove-image-card{position:absolute;right:6px;top:6px}.module-job .remove-image-list i.icon,.module-job .remove-image-card i.icon{font-size:26px}@media screen and (orientation:landscape){.has-footer-fixed .module-job .search-action{bottom:calc(2vw + 60px)}}@media screen and (orientation:portrait){.has-footer-fixed .module-job .search-action{bottom:calc(2vh + 60px)}}.job-icon-small:before{font-size:20px!important}.job-location-action:before{font-size:26px!important}","job")